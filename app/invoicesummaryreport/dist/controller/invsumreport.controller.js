sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/export/library","sap/ui/export/Spreadsheet","sap/m/MessageToast","sap/ushell/Container"],function(e,t,i,a){"use strict";var s=sap.ui.export.EdmType;return e.extend("invoicesummaryreport.controller.invsumreport",{onInit:function(){},onAfterRendering:async function(e){debugger;this.getView().byId("t1").addStyleClass("t1");this.getView().byId("t2").addStyleClass("t1");this.getView().byId("t3").addStyleClass("t1");this.getView().byId("t4").addStyleClass("t1");this.getView().byId("t5").addStyleClass("t1");this.getView().byId("t6").addStyleClass("t1");this.getView().byId("t7").addStyleClass("t1");this.getView().byId("t8").addStyleClass("t1");this.getView().byId("t9").addStyleClass("t1");this.getView().byId("t10").addStyleClass("t1");this.getView().byId("t11").addStyleClass("t1");this.getView().byId("t12").addStyleClass("t1");this.getView().byId("t13").addStyleClass("t1");this.getView().byId("t14").addStyleClass("t1");this.getView().byId("t15").addStyleClass("t1");this.getView().byId("t16").addStyleClass("t1");this.getView().byId("t17").addStyleClass("t1");this.getView().byId("t18").addStyleClass("t1")},butt:async function(e){debugger;const t=await sap.ushell.Container.getServiceAsync("Navigation");const i=await t.navigate({target:{semanticObject:"chart",action:"display"}})},createColumnConfig:function(){return[{label:"Invoice No",property:"Invoice_No",type:s.String},{label:"Vendor Name",property:"Vendor_name",type:s.String},{label:"Vendor No",property:"Vendor_No",type:s.String},{label:"Document Type",property:"Document_Type",type:s.String},{label:"Overdue_Flag",property:"Overdue_Flag",type:s.String},{label:"Invoice Status",property:"Invoice_Status",type:s.String},{label:"Amount",property:"Amount",type:s.String},{label:"Invoice Date",property:"Invoice_Date",type:s.String},{label:"Due Date",property:"Due_Date",type:s.String},{label:"Payment Terms",property:"Payment_Terms",type:s.String},{label:"Days to Due",property:"Days_to_Due",type:s.String},{label:"Ref Po No",property:"Ref_Po_No",type:s.String},{label:"Comp Code",property:"Comp_Code",type:s.String},{label:"Ap Processor",property:"Ap_Processor",type:s.String},{label:"Approvers",property:"Approvers",type:s.String},{label:"Start Date",property:"Start_Date",type:s.String},{label:"End Date",property:"End_Date",type:s.String},{label:"Process Duration",property:"Process_Duration",type:s.String}]},down:async function(e){var t,i,a,s,r;debugger;i=this.byId("idProductsTable");a=i.getBinding("items");t=this.createColumnConfig();console.log();s={workbook:{columns:t},dataSource:a};r=new sap.ui.export.Spreadsheet(s);r.build().then(function(){MessageToast.show("Spreadsheet export has finished")}).finally(function(){r.destroy()})},search:function(){debugger;var e=this.getView().byId("combo1").getSelectedKeys();var t=this.getView().byId("combo2").getSelectedKeys();var i=this.getView().byId("idProductsTable");var a=i.getBinding("items");if(t.length>0){var s=new sap.m.BusyDialog({text:`Fetching Vendor name with ${t}`});s.open();var r=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Vendor_name",sap.ui.model.FilterOperator.Contains,t)],and:false});a.filter([r]);setTimeout(function(){s.close()},1e3)}else if(e.length>0){var o=new sap.m.BusyDialog({text:`Fetching Invoice No with ${e}`});o.open();var n=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("Invoice_No",sap.ui.model.FilterOperator.Contains,e)],and:false});a.filter([n]);setTimeout(function(){o.close()},1e3)}else{var l=new sap.m.BusyDialog({text:"Fetching All Data"});l.open();a.filter([]);setTimeout(function(){l.close()},1e3)}},onLogoPressed:function(){var e=this.getView().byId("f1");var t=e.getVisible();e.setVisible(!t)}})});
//# sourceMappingURL=invsumreport.controller.js.map